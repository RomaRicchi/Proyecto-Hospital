extends layout_modular

block content
  .admin-hero.d-flex.align-items-center.justify-content-center.text-center
    .container
      h1.text-center.px-4.pt-5 Panel de Salud

      if usuario
        p.text-end
          strong Usuario: 
          | #{usuario.nombre} #{usuario.apellido}

      h4 Pacientes asignados

      .table-responsive
        table#tablaPacientes.table.table-striped.table-bordered.w-100
          thead
            tr
              th DNI
              th Nombre completo
              th Cama
              th Fecha de ingreso
              th Motivo ingreso
              th Acciones
          tbody
            each m in movimientos
              - var habNum = (m.cama && m.cama.habitacion && m.cama.habitacion.num) || '?'
              - var sectorNombre = (m.cama && m.cama.habitacion && m.cama.habitacion.sector && m.cama.habitacion.sector.nombre) || '?'
              tr(data-dni=m.admision.paciente.dni_paciente style="cursor:pointer; white-space: nowrap;")
                td= m.admision.paciente.dni_paciente
                td= `${m.admision.paciente.apellido_p}, ${m.admision.paciente.nombre_p}`
                td= m.cama ? `${m.cama.nombre} - Hab ${habNum} / ${sectorNombre}` : '-'
                td= m.fecha_hora_ingreso.toLocaleString('es-AR')
                td= m.admision.motivo_ingreso ? m.admision.motivo_ingreso.nombre : '-'
                td
                  a.btn.btn-sm.btn-info(href=`/registroClinico?dni=${m.admision.paciente.dni_paciente}`)
                    i.fas.fa-notes-medical.me-1
                    | Registro

      script(src="https://code.jquery.com/jquery-3.6.0.min.js")
      script(src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js")
      script(src="https://cdn.datatables.net/responsive/2.4.1/js/dataTables.responsive.min.js")
      link(rel="stylesheet", href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css")
      link(rel="stylesheet", href="https://cdn.datatables.net/responsive/2.4.1/css/responsive.dataTables.min.css")
      script(src="/js/panelSalud.js")
