import cron from 'node-cron';
import { eliminarReservasVencidas } from '../app/controllers/confirmarReserva.controller.js';

export function iniciarEliminacionReservas() {
  // Ejecutar todos los d√≠as a la 1 AM
  cron.schedule('0 1 * * *', async () => {
    console.log('üßπ Ejecutando eliminaci√≥n de reservas vencidas...');

    try {
      await eliminarReservasVencidas(
        {}, // req simulado
        { 
          json: msg => console.log('‚úÖ', msg),
          status: code => ({ json: err => console.error(`‚ùå ${code}:`, err) })
        } // res simulado
      );
    } catch (error) {
      console.error('‚ùå Error al ejecutar cron:', error.message);
    }
  });
}
